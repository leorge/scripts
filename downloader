myName=`basename $0`
# Try "bash downloader" and "bash ./downloader" for the following line.
echo -n $myName; [ $0 = $myName ] && echo "" || echo " in $0"
REPO=scripts; INSTALLER=inst_cmd; BIN=~/bin; TMP=/tmp; NULL=/dev/null
if ! which $INSTALLER > $NULL; then
    echo "$INSTALLER is not installed."
    CMD=$TMP/$INSTALLER; mkdir -p $TMP
    [ -f $CMD ] || wget -P $TMP https://github.com/leorge/scripts/raw/master/$INSTALLER
    chmod +x $CMD && PATH=$PATH:$TMP && which $INSTALLER && bash $0    # recursive call
elif [ -d .git ]; then  # in a git repository
    repository=`grep "url = " .git/config | sed -e 's#.*/\(.*\)\.git#\1#'`
    if [ $repository = $REPO ]; then
        $INSTALLER git && echo -n "Pulling the repository... " && git pull
        bash copy2bin
    else
        echo This repository \"$repository\" is wrong.
    fi
elif $INSTALLER git; then   # not in a repository
    git clone https://github.com/leorge/$REPO.git && cd $REPO && bash $myName
elif $INSTALLER unzip; then # unzip(1) is available
    ZIP=master.zip
    wget -N https://github.com/leorge/$REPO/archive/$ZIP && \
    unzip $ZIP && cd $REPO && bash $myName
else
    ERR=$?
    echo "You can not install git and unzip" >&2
    echo "Please clone the repository \"$REPO\" under another operating system, then retry."
    exit $ERR
fi
